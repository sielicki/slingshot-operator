---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.19.0
  name: cxidrivers.cxi.hpe.com
spec:
  group: cxi.hpe.com
  names:
    kind: CXIDriver
    listKind: CXIDriverList
    plural: cxidrivers
    singular: cxidriver
  scope: Cluster
  versions:
  - additionalPrinterColumns:
    - jsonPath: .spec.version
      name: Version
      type: string
    - jsonPath: .status.ready
      name: Ready
      type: integer
    - jsonPath: .status.updating
      name: Updating
      type: integer
    - jsonPath: .status.failed
      name: Failed
      type: integer
    - jsonPath: .metadata.creationTimestamp
      name: Age
      type: date
    name: v1
    schema:
      openAPIV3Schema:
        description: |-
          CXIDriver is the Schema for the cxidrivers API.
          It defines the cluster-wide configuration for CXI driver management.
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: CXIDriverSpec defines the desired state of CXIDriver
            properties:
              devicePlugin:
                description: DevicePlugin defines device plugin configuration
                properties:
                  enabled:
                    default: true
                    description: Enabled specifies whether the device plugin is enabled
                    type: boolean
                  image:
                    description: Image is the container image for the device plugin
                    type: string
                  resourceName:
                    default: hpe.com/cxi
                    description: ResourceName is the extended resource name (e.g.,
                      "hpe.com/cxi")
                    type: string
                  sharedCapacity:
                    default: 100
                    description: SharedCapacity is the max pods per node when sharingMode
                      is "shared"
                    format: int32
                    minimum: 1
                    type: integer
                  sharingMode:
                    default: shared
                    description: SharingMode defines how devices are shared among
                      pods
                    enum:
                    - shared
                    - exclusive
                    type: string
                type: object
              metricsExporter:
                description: MetricsExporter defines metrics exporter configuration
                properties:
                  enabled:
                    default: true
                    description: Enabled specifies whether the metrics exporter is
                      enabled
                    type: boolean
                  image:
                    description: Image is the container image for the metrics exporter
                    type: string
                  port:
                    default: 9090
                    description: Port is the port for Prometheus metrics endpoint
                    format: int32
                    type: integer
                  resources:
                    description: Resources defines resource requirements for the metrics
                      exporter
                    properties:
                      claims:
                        description: |-
                          Claims lists the names of resources, defined in spec.resourceClaims,
                          that are used by this container.

                          This field depends on the
                          DynamicResourceAllocation feature gate.

                          This field is immutable. It can only be set for containers.
                        items:
                          description: ResourceClaim references one entry in PodSpec.ResourceClaims.
                          properties:
                            name:
                              description: |-
                                Name must match the name of one entry in pod.spec.resourceClaims of
                                the Pod where this field is used. It makes that resource available
                                inside a container.
                              type: string
                            request:
                              description: |-
                                Request is the name chosen for a request in the referenced claim.
                                If empty, everything from the claim is made available, otherwise
                                only the result of this request.
                              type: string
                          required:
                          - name
                          type: object
                        type: array
                        x-kubernetes-list-map-keys:
                        - name
                        x-kubernetes-list-type: map
                      limits:
                        additionalProperties:
                          anyOf:
                          - type: integer
                          - type: string
                          pattern: ^(\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))(([KMGTPE]i)|[numkMGTPE]|([eE](\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))))?$
                          x-kubernetes-int-or-string: true
                        description: |-
                          Limits describes the maximum amount of compute resources allowed.
                          More info: https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/
                        type: object
                      requests:
                        additionalProperties:
                          anyOf:
                          - type: integer
                          - type: string
                          pattern: ^(\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))(([KMGTPE]i)|[numkMGTPE]|([eE](\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))))?$
                          x-kubernetes-int-or-string: true
                        description: |-
                          Requests describes the minimum amount of compute resources required.
                          If Requests is omitted for a container, it defaults to Limits if that is explicitly specified,
                          otherwise to an implementation-defined value. Requests cannot exceed Limits.
                          More info: https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/
                        type: object
                    type: object
                type: object
              nodeSelector:
                additionalProperties:
                  type: string
                description: NodeSelector selects which nodes the operator manages
                type: object
              retryHandler:
                description: RetryHandler defines retry handler configuration
                properties:
                  daemonset:
                    description: DaemonSet contains DaemonSet-specific configuration
                    properties:
                      nodeSelector:
                        additionalProperties:
                          type: string
                        description: NodeSelector for the retry handler DaemonSet
                        type: object
                      resources:
                        description: Resources defines resource requirements for the
                          retry handler DaemonSet
                        properties:
                          claims:
                            description: |-
                              Claims lists the names of resources, defined in spec.resourceClaims,
                              that are used by this container.

                              This field depends on the
                              DynamicResourceAllocation feature gate.

                              This field is immutable. It can only be set for containers.
                            items:
                              description: ResourceClaim references one entry in PodSpec.ResourceClaims.
                              properties:
                                name:
                                  description: |-
                                    Name must match the name of one entry in pod.spec.resourceClaims of
                                    the Pod where this field is used. It makes that resource available
                                    inside a container.
                                  type: string
                                request:
                                  description: |-
                                    Request is the name chosen for a request in the referenced claim.
                                    If empty, everything from the claim is made available, otherwise
                                    only the result of this request.
                                  type: string
                              required:
                              - name
                              type: object
                            type: array
                            x-kubernetes-list-map-keys:
                            - name
                            x-kubernetes-list-type: map
                          limits:
                            additionalProperties:
                              anyOf:
                              - type: integer
                              - type: string
                              pattern: ^(\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))(([KMGTPE]i)|[numkMGTPE]|([eE](\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))))?$
                              x-kubernetes-int-or-string: true
                            description: |-
                              Limits describes the maximum amount of compute resources allowed.
                              More info: https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/
                            type: object
                          requests:
                            additionalProperties:
                              anyOf:
                              - type: integer
                              - type: string
                              pattern: ^(\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))(([KMGTPE]i)|[numkMGTPE]|([eE](\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))))?$
                              x-kubernetes-int-or-string: true
                            description: |-
                              Requests describes the minimum amount of compute resources required.
                              If Requests is omitted for a container, it defaults to Limits if that is explicitly specified,
                              otherwise to an implementation-defined value. Requests cannot exceed Limits.
                              More info: https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/
                            type: object
                        type: object
                      tolerations:
                        description: Tolerations for the retry handler DaemonSet
                        items:
                          description: |-
                            The pod this Toleration is attached to tolerates any taint that matches
                            the triple <key,value,effect> using the matching operator <operator>.
                          properties:
                            effect:
                              description: |-
                                Effect indicates the taint effect to match. Empty means match all taint effects.
                                When specified, allowed values are NoSchedule, PreferNoSchedule and NoExecute.
                              type: string
                            key:
                              description: |-
                                Key is the taint key that the toleration applies to. Empty means match all taint keys.
                                If the key is empty, operator must be Exists; this combination means to match all values and all keys.
                              type: string
                            operator:
                              description: |-
                                Operator represents a key's relationship to the value.
                                Valid operators are Exists, Equal, Lt, and Gt. Defaults to Equal.
                                Exists is equivalent to wildcard for value, so that a pod can
                                tolerate all taints of a particular category.
                                Lt and Gt perform numeric comparisons (requires feature gate TaintTolerationComparisonOperators).
                              type: string
                            tolerationSeconds:
                              description: |-
                                TolerationSeconds represents the period of time the toleration (which must be
                                of effect NoExecute, otherwise this field is ignored) tolerates the taint. By default,
                                it is not set, which means tolerate the taint forever (do not evict). Zero and
                                negative values will be treated as 0 (evict immediately) by the system.
                              format: int64
                              type: integer
                            value:
                              description: |-
                                Value is the taint value the toleration matches to.
                                If the operator is Exists, the value should be empty, otherwise just a regular string.
                              type: string
                          type: object
                        type: array
                    type: object
                  enabled:
                    default: true
                    description: Enabled specifies whether the retry handler is enabled
                    type: boolean
                  image:
                    description: Image is the container image for the retry handler
                    type: string
                  mode:
                    default: daemonset
                    description: Mode specifies the retry handler deployment mode
                    enum:
                    - daemonset
                    - sidecar
                    - kernel
                    - none
                    type: string
                  sidecar:
                    description: Sidecar contains sidecar-specific configuration
                    properties:
                      resources:
                        description: Resources defines resource requirements for the
                          sidecar container
                        properties:
                          claims:
                            description: |-
                              Claims lists the names of resources, defined in spec.resourceClaims,
                              that are used by this container.

                              This field depends on the
                              DynamicResourceAllocation feature gate.

                              This field is immutable. It can only be set for containers.
                            items:
                              description: ResourceClaim references one entry in PodSpec.ResourceClaims.
                              properties:
                                name:
                                  description: |-
                                    Name must match the name of one entry in pod.spec.resourceClaims of
                                    the Pod where this field is used. It makes that resource available
                                    inside a container.
                                  type: string
                                request:
                                  description: |-
                                    Request is the name chosen for a request in the referenced claim.
                                    If empty, everything from the claim is made available, otherwise
                                    only the result of this request.
                                  type: string
                              required:
                              - name
                              type: object
                            type: array
                            x-kubernetes-list-map-keys:
                            - name
                            x-kubernetes-list-type: map
                          limits:
                            additionalProperties:
                              anyOf:
                              - type: integer
                              - type: string
                              pattern: ^(\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))(([KMGTPE]i)|[numkMGTPE]|([eE](\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))))?$
                              x-kubernetes-int-or-string: true
                            description: |-
                              Limits describes the maximum amount of compute resources allowed.
                              More info: https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/
                            type: object
                          requests:
                            additionalProperties:
                              anyOf:
                              - type: integer
                              - type: string
                              pattern: ^(\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))(([KMGTPE]i)|[numkMGTPE]|([eE](\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))))?$
                              x-kubernetes-int-or-string: true
                            description: |-
                              Requests describes the minimum amount of compute resources required.
                              If Requests is omitted for a container, it defaults to Limits if that is explicitly specified,
                              otherwise to an implementation-defined value. Requests cannot exceed Limits.
                              More info: https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/
                            type: object
                        type: object
                    type: object
                type: object
              source:
                description: Source defines where to get the driver from
                properties:
                  prebuiltCache:
                    description: PrebuiltCache is the container image repository for
                      pre-built modules
                    type: string
                  repository:
                    description: Repository is the container image repository for
                      driver source
                    type: string
                  type:
                    default: dkms
                    description: Type specifies how the driver is installed
                    enum:
                    - dkms
                    - prebuilt
                    - preinstalled
                    type: string
                type: object
              updateStrategy:
                description: UpdateStrategy defines how driver updates are rolled
                  out
                properties:
                  healthCheckTimeout:
                    default: 5m
                    description: HealthCheckTimeout is the duration to wait for health
                      checks after update
                    type: string
                  maxUnavailable:
                    default: 10%
                    description: MaxUnavailable is the maximum number of nodes that
                      can be unavailable during update
                    type: string
                  rollbackOnFailure:
                    default: true
                    description: RollbackOnFailure enables automatic rollback if update
                      fails health checks
                    type: boolean
                  type:
                    default: RollingUpdate
                    description: Type specifies the update strategy type
                    enum:
                    - RollingUpdate
                    - OnDelete
                    type: string
                type: object
              version:
                description: Version is the driver version to install
                type: string
            required:
            - version
            type: object
          status:
            description: CXIDriverStatus defines the observed state of CXIDriver
            properties:
              conditions:
                description: Conditions represent the current state of the CXIDriver
                  resource
                items:
                  description: Condition contains details for one aspect of the current
                    state of this API Resource.
                  properties:
                    lastTransitionTime:
                      description: |-
                        lastTransitionTime is the last time the condition transitioned from one status to another.
                        This should be when the underlying condition changed.  If that is not known, then using the time when the API field changed is acceptable.
                      format: date-time
                      type: string
                    message:
                      description: |-
                        message is a human readable message indicating details about the transition.
                        This may be an empty string.
                      maxLength: 32768
                      type: string
                    observedGeneration:
                      description: |-
                        observedGeneration represents the .metadata.generation that the condition was set based upon.
                        For instance, if .metadata.generation is currently 12, but the .status.conditions[x].observedGeneration is 9, the condition is out of date
                        with respect to the current state of the instance.
                      format: int64
                      minimum: 0
                      type: integer
                    reason:
                      description: |-
                        reason contains a programmatic identifier indicating the reason for the condition's last transition.
                        Producers of specific condition types may define expected values and meanings for this field,
                        and whether the values are considered a guaranteed API.
                        The value should be a CamelCase string.
                        This field may not be empty.
                      maxLength: 1024
                      minLength: 1
                      pattern: ^[A-Za-z]([A-Za-z0-9_,:]*[A-Za-z0-9_])?$
                      type: string
                    status:
                      description: status of the condition, one of True, False, Unknown.
                      enum:
                      - "True"
                      - "False"
                      - Unknown
                      type: string
                    type:
                      description: type of condition in CamelCase or in foo.example.com/CamelCase.
                      maxLength: 316
                      pattern: ^([a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*/)?(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])$
                      type: string
                  required:
                  - lastTransitionTime
                  - message
                  - reason
                  - status
                  - type
                  type: object
                type: array
                x-kubernetes-list-map-keys:
                - type
                x-kubernetes-list-type: map
              driverVersion:
                description: DriverVersion is the currently deployed driver version
                type: string
              failed:
                description: Failed is the number of nodes in failed state
                format: int32
                type: integer
              observedGeneration:
                description: ObservedGeneration is the most recent generation observed
                  by the controller
                format: int64
                type: integer
              ready:
                description: Ready is the number of nodes with driver ready
                format: int32
                type: integer
              retryHandlerMode:
                description: RetryHandlerMode is the currently active retry handler
                  mode
                enum:
                - daemonset
                - sidecar
                - kernel
                - none
                type: string
              updating:
                description: Updating is the number of nodes currently updating
                format: int32
                type: integer
              webhookReady:
                description: WebhookReady indicates if the sidecar injection webhook
                  is ready (when mode=sidecar)
                type: boolean
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
